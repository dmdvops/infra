---
- name: "Deploy application"
  hosts: app
  tasks:
    - name: "Actual code of  application"
      git:
        repo: 'https://github.com/Artemmkin/reddit.git'
        dest: /home/appuser/reddit
        version: monolith
      notify: restart puma.service

    - name: Installs gems using a Gemfile
      bundler:
        state: present
        chdir: /home/appuser/reddit

  handlers:
    - name: restart puma.service
      become: yes
      systemd:
        name: puma.service
        state: restarted
